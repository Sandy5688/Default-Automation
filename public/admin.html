<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Automation - Admin Dashboard</title>
    <link rel="stylesheet" href="/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="admin-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-robot"></i> Admin Panel</h2>
                <div class="system-status">
                    <span id="system-mode" class="mode-badge">LIVE</span>
                </div>
            </div>
            <ul class="sidebar-menu">
                <li><a href="#dashboard" class="menu-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i> Dashboard
                </a></li>
                <li><a href="#posts" class="menu-item" data-section="posts">
                    <i class="fas fa-list"></i> Post Queue
                </a></li>
                <li><a href="#media-generator" class="menu-item" data-section="media-generator">
                    <i class="fas fa-magic"></i> Media Generator
                </a></li>
                <li><a href="#notifications" class="menu-item" data-section="notifications">
                    <i class="fas fa-bell"></i> Notifications
                </a></li>
                <li><a href="#rewards" class="menu-item" data-section="rewards">
                    <i class="fas fa-gift"></i> Rewards
                </a></li>
                <li><a href="#engagement" class="menu-item" data-section="engagement">
                    <i class="fas fa-heart"></i> Engagement
                </a></li>
                <li><a href="#users" class="menu-item" data-section="users">
                    <i class="fas fa-users"></i> Users
                </a></li>
                <li><a href="#bots" class="menu-item" data-section="bots">
                    <i class="fas fa-robot"></i> Bots
                </a></li>
                <li><a href="#blogs" class="menu-item" data-section="blogs">
                    <i class="fas fa-blog"></i> Blogs
                </a></li>
                <li><a href="#settings" class="menu-item" data-section="settings">
                    <i class="fas fa-cog"></i> Settings
                </a></li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-bar">
                <h1 id="page-title">Dashboard</h1>
                <div class="top-bar-actions">
                    <div class="system-info">
                        <span class="status-indicator" id="supabase-status">ðŸŸ¢</span>
                        <span>Supabase</span>
                    </div>
                    <div class="user-info">
                        <span>Admin User</span>
                        <i class="fas fa-user-circle"></i>
                    </div>
                </div>
            </header>

            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-list"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-posts">0</h3>
                            <p>Total Posts</p>
                            <small id="pending-posts">0 pending</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-users">0</h3>
                            <p>Active Users</p>
                            <small id="new-users">0 new today</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="total-engagement">0</h3>
                            <p>Total Engagement</p>
                            <small id="engagement-growth">+0% today</small>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-gift"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="rewards-issued">0</h3>
                            <p>Rewards Issued</p>
                            <small id="pending-rewards">0 pending</small>
                        </div>
                    </div>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3>Platform Performance</h3>
                        <canvas id="platformChart" width="400" height="200"></canvas>
                    </div>
                    <div class="dashboard-card">
                        <h3>Recent Activity</h3>
                        <div id="recent-activity" class="activity-list">
                            <!-- Activity items will be loaded here -->
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>Bot Status</h3>
                        <div class="bot-status-grid" id="bot-status-overview">
                            <!-- Bot status will be loaded here -->
                        </div>
                    </div>
                    <div class="dashboard-card">
                        <h3>System Health</h3>
                        <div class="health-metrics">
                            <div class="health-item">
                                <span>Queue Processing</span>
                                <span class="status-badge connected" id="queue-status">Active</span>
                            </div>
                            <div class="health-item">
                                <span>Media Generation</span>
                                <span class="status-badge connected" id="media-status">Ready</span>
                            </div>
                            <div class="health-item">
                                <span>Notifications</span>
                                <span class="status-badge connected" id="notification-status">Online</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Post Queue Management Section -->
            <section id="posts" class="content-section">
                <div class="section-header">
                    <h2>Post Queue Management</h2>
                    <div class="header-actions">
                        <select id="platform-filter" onchange="filterPosts()">
                            <option value="all">All Platforms</option>
                            <option value="instagram">Instagram</option>
                            <option value="twitter">Twitter</option>
                            <option value="tiktok">TikTok</option>
                            <option value="facebook">Facebook</option>
                            <option value="reddit">Reddit</option>
                            <option value="telegram">Telegram</option>
                            <option value="pinterest">Pinterest</option>
                        </select>
                        <select id="status-filter" onchange="filterPosts()">
                            <option value="all">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="posted">Posted</option>
                            <option value="failed">Failed</option>
                            <option value="queued">Queued</option>
                        </select>
                        <button class="btn btn-warning" onclick="retryAllFailed()">
                            <i class="fas fa-redo"></i> Retry All Failed
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Platform</th>
                                <th>Caption</th>
                                <th>Media</th>
                                <th>Status</th>
                                <th>Scheduled</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="posts-table-body">
                            <!-- Posts will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Media Generator Section -->
            <section id="media-generator" class="content-section">
                <div class="section-header">
                    <h2>AI Media Generator</h2>
                </div>
                <div class="generator-grid">
                    <div class="generator-card">
                        <h3><i class="fas fa-image"></i> Image Generation</h3>
                        <div class="generator-form">
                            <textarea id="image-prompt" placeholder="Describe the image you want to generate..." rows="3"></textarea>
                            <div class="form-row">
                                <select id="image-style">
                                    <option value="realistic">Realistic</option>
                                    <option value="artistic">Artistic</option>
                                    <option value="cartoon">Cartoon</option>
                                    <option value="abstract">Abstract</option>
                                </select>
                                <button class="btn btn-primary" onclick="generateImage()">
                                    <i class="fas fa-magic"></i> Generate Image
                                </button>
                            </div>
                        </div>
                        <div id="image-preview" class="media-preview">
                            <div class="preview-placeholder">
                                <i class="fas fa-image"></i>
                                <p>Generated image will appear here</p>
                            </div>
                        </div>
                    </div>
                    <div class="generator-card">
                        <h3><i class="fas fa-video"></i> Video Generation</h3>
                        <div class="generator-form">
                            <textarea id="video-prompt" placeholder="Describe the video you want to generate..." rows="3"></textarea>
                            <div class="form-row">
                                <select id="video-duration">
                                    <option value="3">3 seconds</option>
                                    <option value="5">5 seconds</option>
                                    <option value="10">10 seconds</option>
                                </select>
                                <button class="btn btn-primary" onclick="generateVideo()">
                                    <i class="fas fa-video"></i> Generate Video
                                </button>
                            </div>
                        </div>
                        <div id="video-preview" class="media-preview">
                            <div class="preview-placeholder">
                                <i class="fas fa-video"></i>
                                <p>Generated video will appear here</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="caption-generator">
                    <h3><i class="fas fa-pen"></i> AI Caption Generator</h3>
                    <div class="caption-form">
                        <div class="form-row">
                            <input type="text" id="caption-topic" placeholder="Topic or theme for caption">
                            <select id="caption-tone">
                                <option value="casual">Casual</option>
                                <option value="professional">Professional</option>
                                <option value="funny">Funny</option>
                                <option value="inspirational">Inspirational</option>
                            </select>
                            <button class="btn btn-success" onclick="generateCaption()">
                                <i class="fas fa-magic"></i> Generate Caption
                            </button>
                        </div>
                        <div id="generated-caption" class="caption-preview">
                            <p>Generated caption will appear here...</p>
                        </div>
                    </div>
                </div>
                <div class="schedule-post">
                    <h3><i class="fas fa-calendar"></i> Schedule Post</h3>
                    <div class="schedule-form">
                        <div class="form-row">
                            <select id="schedule-platform" multiple>
                                <option value="instagram">Instagram</option>
                                <option value="twitter">Twitter</option>
                                <option value="tiktok">TikTok</option>
                                <option value="facebook">Facebook</option>
                            </select>
                            <input type="datetime-local" id="schedule-time">
                            <button class="btn btn-primary" onclick="schedulePost()">
                                <i class="fas fa-clock"></i> Schedule Post
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Notifications Section -->
            <section id="notifications" class="content-section">
                <div class="section-header">
                    <h2>Notification Center</h2>
                    <div class="header-actions">
                        <button class="btn btn-secondary" onclick="markAllAsRead()">
                            <i class="fas fa-check-double"></i> Mark All Read
                        </button>
                        <button class="btn btn-primary" onclick="openCreateNotificationModal()">
                            <i class="fas fa-plus"></i> Create Notification
                        </button>
                    </div>
                </div>
                <div class="notifications-container">
                    <div class="notification-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="unread">Unread</button>
                        <button class="filter-btn" data-filter="reward">Rewards</button>
                        <button class="filter-btn" data-filter="system">System</button>
                    </div>
                    <div id="notifications-list" class="notifications-list">
                        <!-- Notifications will be loaded here -->
                    </div>
                </div>
            </section>

            <!-- Rewards Section -->
            <section id="rewards" class="content-section">
                <div class="section-header">
                    <h2>Reward System</h2>
                    <div class="header-actions">
                        <select id="reward-tier-filter" onchange="filterRewards()">
                            <option value="all">All Tiers</option>
                            <option value="silver">Silver</option>
                            <option value="gold">Gold</option>
                            <option value="viral">Viral</option>
                        </select>
                        <button class="btn btn-primary" onclick="openIssueRewardModal()">
                            <i class="fas fa-gift"></i> Issue Reward
                        </button>
                    </div>
                </div>
                <div class="rewards-overview">
                    <div class="reward-stats">
                        <div class="reward-stat">
                            <i class="fas fa-medal" style="color: #c0c0c0;"></i>
                            <div>
                                <h3 id="silver-rewards">0</h3>
                                <p>Silver Rewards</p>
                            </div>
                        </div>
                        <div class="reward-stat">
                            <i class="fas fa-medal" style="color: #ffd700;"></i>
                            <div>
                                <h3 id="gold-rewards">0</h3>
                                <p>Gold Rewards</p>
                            </div>
                        </div>
                        <div class="reward-stat">
                            <i class="fas fa-trophy" style="color: #ff6b6b;"></i>
                            <div>
                                <h3 id="viral-rewards">0</h3>
                                <p>Viral Rewards</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>User</th>
                                <th>Tier</th>
                                <th>Amount</th>
                                <th>Reason</th>
                                <th>Status</th>
                                <th>Issued</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="rewards-table-body">
                            <!-- Rewards will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Engagement Section -->
            <section id="engagement" class="content-section">
                <div class="section-header">
                    <h2>Engagement Tracker</h2>
                    <div class="header-actions">
                        <select id="engagement-platform-filter" onchange="filterEngagement()">
                            <option value="all">All Platforms</option>
                            <option value="instagram">Instagram</option>
                            <option value="twitter">Twitter</option>
                            <option value="tiktok">TikTok</option>
                            <option value="facebook">Facebook</option>
                        </select>
                        <input type="text" id="engagement-user-search" placeholder="Search user..." onkeyup="searchEngagement()">
                    </div>
                </div>
                <div class="engagement-overview">
                    <div class="engagement-chart">
                        <canvas id="engagementChart" width="400" height="200"></canvas>
                    </div>
                    <div class="top-performers">
                        <h3>Top Performers</h3>
                        <div id="top-performers-list">
                            <!-- Top performers will be loaded here -->
                        </div>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Post</th>
                                <th>Platform</th>
                                <th>User</th>
                                <th>Likes</th>
                                <th>Shares</th>
                                <th>Views</th>
                                <th>Score</th>
                                <th>Reward</th>
                            </tr>
                        </thead>
                        <tbody id="engagement-table-body">
                            <!-- Engagement data will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Users Section -->
            <section id="users" class="content-section">
                <div class="section-header">
                    <h2>User Management</h2>
                    <div class="header-actions">
                        <div class="filter-toggles">
                            <label class="toggle-label">
                                <input type="checkbox" id="show-active" checked onchange="filterUsers()">
                                <span>Active</span>
                            </label>
                            <label class="toggle-label">
                                <input type="checkbox" id="show-inactive" onchange="filterUsers()">
                                <span>Inactive</span>
                            </label>
                            <label class="toggle-label">
                                <input type="checkbox" id="show-deleted" onchange="filterUsers()">
                                <span>Deleted</span>
                            </label>
                        </div>
                        <button class="btn btn-danger" onclick="deleteInactiveUsers()">
                            <i class="fas fa-trash"></i> Delete Inactive
                        </button>
                    </div>
                </div>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Posts</th>
                                <th>Rewards</th>
                                <th>Status</th>
                                <th>Last Active</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="users-table-body">
                            <!-- Users will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Bots Section -->
            <section id="bots" class="content-section">
                <div class="section-header">
                    <h2>Bot Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="runAllBots()">
                            <i class="fas fa-play"></i> Run All Bots
                        </button>
                        <button class="btn btn-warning" onclick="restartCronJobs()">
                            <i class="fas fa-refresh"></i> Restart Cron Jobs
                        </button>
                    </div>
                </div>
                <div class="bots-grid">
                    <div class="bot-card" data-bot="instagram">
                        <div class="bot-header">
                            <i class="fab fa-instagram"></i>
                            <h3>Instagram Bot</h3>
                            <span class="bot-status" id="instagram-status">ðŸŸ¢ Idle</span>
                        </div>
                        <div class="bot-stats">
                            <div class="stat">
                                <span>Last Run:</span>
                                <span id="instagram-last-run">Never</span>
                            </div>
                            <div class="stat">
                                <span>Success Rate:</span>
                                <span id="instagram-success-rate">0%</span>
                            </div>
                        </div>
                        <div class="bot-actions">
                            <button class="btn btn-primary" onclick="runBot('instagram')">
                                <i class="fas fa-play"></i> Run Now
                            </button>
                            <button class="btn btn-secondary" onclick="viewBotLogs('instagram')">
                                <i class="fas fa-eye"></i> View Logs
                            </button>
                            <button class="btn btn-warning" onclick="configureBotSettings('instagram')">
                                <i class="fas fa-cog"></i> Settings
                            </button>
                        </div>
                    </div>
                    <!-- Repeat for other bots -->
                </div>
                <div class="cron-schedule">
                    <h3>Cron Schedule</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Bot</th>
                                    <th>Schedule</th>
                                    <th>Next Run</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="cron-table-body">
                                <!-- Cron jobs will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Blogs Section -->
            <section id="blogs" class="content-section">
                <div class="section-header">
                    <h2>Blog Management</h2>
                    <div class="header-actions">
                        <button class="btn btn-primary" onclick="openBlogGeneratorModal()">
                            <i class="fas fa-plus"></i> Generate Blog
                        </button>
                    </div>
                </div>
                <div class="blog-generator">
                    <div class="generator-form">
                        <textarea id="blog-prompt" placeholder="Enter blog topic or prompt..." rows="4"></textarea>
                        <div class="form-row">
                            <select id="blog-length">
                                <option value="short">Short (500-800 words)</option>
                                <option value="medium">Medium (800-1500 words)</option>
                                <option value="long">Long (1500+ words)</option>
                            </select>
                            <select id="blog-tone">
                                <option value="professional">Professional</option>
                                <option value="casual">Casual</option>
                                <option value="technical">Technical</option>
                                <option value="creative">Creative</option>
                            </select>
                            <button class="btn btn-success" onclick="generateBlog()">
                                <i class="fas fa-magic"></i> Generate Blog
                            </button>
                        </div>
                    </div>
                    <div id="blog-preview" class="blog-preview">
                        <div class="preview-placeholder">
                            <i class="fas fa-file-alt"></i>
                            <p>Generated blog will appear here</p>
                        </div>
                    </div>
                </div>
                <div class="blog-syndication">
                    <h3>Blog Syndication</h3>
                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Created</th>
                                    <th>Medium</th>
                                    <th>Substack</th>
                                    <th>Reddit</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="blogs-table-body">
                                <!-- Blogs will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settings" class="content-section">
                <div class="section-header">
                    <h2>System Settings</h2>
                    <div class="header-actions">
                        <button class="btn btn-success" onclick="saveSettings()">
                            <i class="fas fa-save"></i> Save Settings
                        </button>
                    </div>
                </div>
                <div class="settings-grid">
                    <div class="settings-card">
                        <h3>System Mode</h3>
                        <div class="mode-controls">
                            <label class="toggle-switch">
                                <input type="checkbox" id="maintenance-mode">
                                <span class="slider"></span>
                                <span class="label">Maintenance Mode</span>
                            </label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="dev-mode">
                                <span class="slider"></span>
                                <span class="label">Development Mode</span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h3>Media Generation</h3>
                        <div class="media-settings">
                            <label class="toggle-switch">
                                <input type="checkbox" id="enable-image-generation" checked>
                                <span class="slider"></span>
                                <span class="label">Enable Image Generation</span>
                            </label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="enable-video-generation" checked>
                                <span class="slider"></span>
                                <span class="label">Enable Video Generation</span>
                            </label>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h3>Environment Variables</h3>
                        <div class="env-vars">
                            <div class="env-var">
                                <label>Supabase URL</label>
                                <input type="text" id="supabase-url" readonly>
                            </div>
                            <div class="env-var">
                                <label>Replicate API Key</label>
                                <input type="password" id="replicate-key">
                            </div>
                            <div class="env-var">
                                <label>OpenAI API Key</label>
                                <input type="password" id="openai-key">
                            </div>
                        </div>
                    </div>
                    <div class="settings-card">
                        <h3>System Actions</h3>
                        <div class="danger-zone">
                            <button class="btn btn-warning" onclick="clearQueue()">
                                <i class="fas fa-trash"></i> Clear Post Queue
                            </button>
                            <button class="btn btn-danger" onclick="restartSystem()">
                                <i class="fas fa-power-off"></i> Restart System
                            </button>
                        </div>
                    </div>
                </div>
                <div class="system-logs">
                    <h3>System Logs</h3>
                    <div class="log-viewer">
                        <div class="log-controls">
                            <select id="log-type-filter">
                                <option value="all">All Logs</option>
                                <option value="error">Errors</option>
                                <option value="warning">Warnings</option>
                                <option value="info">Info</option>
                            </select>
                            <button class="btn btn-secondary" onclick="refreshLogs()">
                                <i class="fas fa-refresh"></i> Refresh
                            </button>
                            <button class="btn btn-danger" onclick="clearLogs()">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                        </div>
                        <div id="system-logs-content" class="logs-content">
                            <!-- Logs will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    <div id="modal-overlay" class="modal-overlay">
        <div id="modal-content" class="modal-content">
            <!-- Modal content will be dynamically loaded -->
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Processing...</p>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <script src="/admin.js"></script>
</body>
</html>
